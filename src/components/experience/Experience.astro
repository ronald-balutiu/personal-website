---
import { getCollection } from 'astro:content'

const experiences = (await getCollection('experience')).sort((a, b) => a.data.order - b.data.order)
---

<section id="experience" class="experience-section" aria-labelledby="experience-title">
  <div class="experience-content">
    <h2 id="experience-title" class="section-title">Experience</h2>
    <div class="experience-list">
      {
        experiences.map((entry) => (
          <article class="experience-item">
            <header class="experience-company-row">
              <h3 class="experience-company">{entry.data.company}</h3>
              <p class="experience-locations">{entry.data.locations.join(' / ')}</p>
            </header>
            <ul class="experience-roles" aria-label={`${entry.data.company} roles`}>
              {entry.data.roles.map((role) => (
                <li class="experience-role-row">
                  <span class="experience-role-title">{role.title}</span>
                  <span class="experience-role-dates">{role.dateRange}</span>
                </li>
              ))}
            </ul>
            <div class="experience-summary">
              {entry.data.highlights.map((paragraph) => (
                <p class="experience-summary-paragraph">{paragraph}</p>
              ))}
            </div>
            {entry.data.technologies.length > 0 && (
              <ul class="experience-tech-list" aria-label={`${entry.data.company} technologies`}>
                {entry.data.technologies.map((technology) => (
                  <li class="experience-tech-chip">{technology}</li>
                ))}
              </ul>
            )}
          </article>
        ))
      }
    </div>
  </div>
</section>
